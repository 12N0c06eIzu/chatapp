----------------------------------
～ネットワークプログラミング　最終課題～
　E18C2017　林 陸斗
 2019/7/1 ~ 2019/8/7
----------------------------------

socket.ioを使用したチャットアプリの制作
スタートの所にある「chatExample」を改良
目指すはSlackのようなUI

----------------------------------
とりあえず必要な機能の書き出し

・文字の送信（chatExample）OK
・チャットの履歴を残しておけるようにする(csvで管理) OK
・ユーザーの登録機能（csvで管理）
・個人チャット（Room）
・入力中のメンバーの名前を表示 OK
・

----------------------------------
こんなこともできたらいいなってこと

・相手がオフラインでもルームに送信できればログイン後に
どのようなメッセージが送られてきたか確認できるようにする(Roomとcsv)
・複数人の入力を正確に表示する（３人程で「多くのユーザーが。。。」というような感じにする）
・サムズアップ、サムズダウンとかあれば多人数チャットにおける簡単な意思表示になっていいと思ったけどhuuum
・お絵かきの森

7/8
・各ルームごとのcsvファイルを用意して、保存するとか？
でもおそらく本日の授業でMongoDBについて触るのでそれを導入することに変わりはないと思う。
----------------------------------
作成日7/1
更新履歴
7/1：
作成、簡単に思いついた内容を記入、今後の修正したことや内容は
きちんと記入していこうと思う。以上!

7/5:
久しぶりに進捗を確認したらroomListが表示されていないことを確認
おそらくformタグがcssで下に表示されている関係でうまく表示されていないと思われる。
とりあえずcssの個別での割り当て方法を見つけて、送信用フォームに名前を付けて現在あるcssのform
を書き換えたらいいと思われる。
とりあえず適当にdevでだしてみるかｗｗｗｗｗ
でたからとりあえずこれで行く

7/10：
前回の授業でdevをformに変更して、それをroomListとして設定した
button名のつけ方は属性を付加した後最後に="ボタン名"

7/15:
とりあえずごちゃってきて、大変だからログイン画面を作成しようと考えました。
とりあえず、ボタンによる画面遷移をしてみる。
location.herfでJavaScriptでURL取得して画面遷移できる
これでもうまくいかなかったので
とりあえず
新しいタブを開いて、チャットのページに飛ぶようにするか

7/16:
画面遷移の際に渡すのはユーザー名だけやしGETパラメーターで送り付けて
はいどうも。。。って感じでいいと思う。
なんでかroomはうまいこと動いたから原因不明です。
ルームの追加も要は、inputの値をボタンを押したらセレクトボックスに追加する
程度のものなのでRoomさえ完成してしまえばどうということはなかろうなのだ
理想の動きとしては
１）”追加”ボタンをクリック
２）promptにてRoom名を入力
３）入力確定ボタンをクリック
４）セレクトボックスにそのルームが増える
ex)自動的にそこをセレクトするといいかもしれないね
くらいだと思う。
room関係は別によけた方がイイかもなのでとりあえずよけてみる
あとwwwが長いから分け方を調べる

不具合について、
うまいこと動いたroom機能はおそらく複数回出入りするとうまく動くようだ。
何が原因なのかねぇ。mainがおかしい説も付けとく。
ログが初回アクセスのみ読み込まれないのも初期化とかに原因があるのかもしれない。
○○さんが入力中に関しても送れが生じていてきもい
あと、ページのユーザーが一度入力するとそれから表示が書き換えられることがないという点も注意

7/17:
最初にlogin.pugを読み込む用にしてから、テスト用のaタグでチャットに飛ぶと
最初の１回目だけログが読み込まれないという不具合が確認されなかったので
途中でサーバーの再起動を行うと発生するのかもしれないと思った。
そこらへん要注意で。

ログイン処理をサーバーで照らし合わせるのか、
ブラウザで照らし合わせるのかだが、
処理的にはサーバーでしてしまった方が楽だと思うが
どうしたらいいのか悩む。

.csvを操作する系は別のjsファイルに移そうと思う。


関数名とかマジで理解不明だったりするから
見ただけでそれがどのような動きをするのか、
どれに対してそのような動きをするのか
コメントでなく”一目見て”わかるようなコーディングを心がケロ

ログを書き込むときに配列に格納するのをやめて
取得して書き込むようにするのもいいかもしれない。
むしろその方が楽なのでは？

本日発生した不具合
・入室メッセージが出力された後に
過去ログが出力されてしまっているのでだるい。
順番考えろｋｓ

7/19:
とりあえずログインページからuserIDを値渡しして
それをユーザー名として表示して出力できたりするようにするのが
最優先だと思う。
入室メッセージが数回に一度ログよりも先に呼び出されてしまう問題

今日できたこと
login.jsとregister.jsからユーザー名をGETパラメータを用いて
chatの方のusernameへ値渡しすることに成功した。
後はユーザーの確認とログイン処理とかができれば一歩近づけると思う。

7/26:
ユーザーのログインを認証するものとユーザーを追加する機能を追加